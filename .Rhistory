}
return(result)
}
optimos_kmeans_videos <- testingOptimalK(videos_kmeans)
optimos_kmeans_video
optimos_kmeans_videos
testingOptimalK <- function(data){
optimistic <- as.integer(sqrt(nrow(data)/2))
kmin <- optimistic-6
kmax <- optimistic+6
if(kmin <= 0){
kmin <- 2
}
result <- matrix(NA, nrow=(kmax-kmin+1), ncol=3)
current_row <- 0
print(paste("Iterando entre",kmin,"y",kmax,"..."))
for(k in kmin:kmax){
print(paste("k:",k))
current_row <- current_row + 1
kbet <- c()
kwit <- c()
for(i in 1:20){
kmeans_result <- kmeans(data,k)
kbet <- append(kbet,kmeans_result$betweenss)
kwit <- append(kwit,kmeans_result$tot.withinss)
}
result[current_row,] <- c(k, mean(kbet), mean(kwit))
}
return(result)
}
optimos_kmeans_videos <- testingOptimalK(videos_kmeans)
optimos_kmeans_videos <- testingOptimalK(videos_kmeans)
optimos_kmeans_videos
optimos_kmeans_videos
names(optimos_kmeans_videos)
names(optimos_kmeans_videos) <- c("K", "betweens (max)", "withins (min)")
optimos_kmeans_videos
testingOptimalK <- function(data){
optimistic <- as.integer(sqrt(nrow(data)/2))
kmin <- optimistic-6
kmax <- optimistic+6
if(kmin <= 0){
kmin <- 2
}
result <- matrix(NA, nrow=(kmax-kmin+2), ncol=3)
current_row <- 1
result[current_row,] <- c("K", "betweens (MAX)", "withins (MIN)")
print(paste("Iterando entre",kmin,"y",kmax,"..."))
for(k in kmin:kmax){
print(paste("k:",k))
current_row <- current_row + 1
kbet <- c()
kwit <- c()
for(i in 1:20){
kmeans_result <- kmeans(data,k)
kbet <- append(kbet,kmeans_result$betweenss)
kwit <- append(kwit,kmeans_result$tot.withinss)
}
result[current_row,] <- c(k, mean(kbet), mean(kwit))
}
return(result)
}
optimos_kmeans_videos <- testingOptimalK(videos_kmeans)
optimos_kmeans_videos
users[1]
users[1,]
users[1,]
videos_kmeans[1,]
a <- data.frame(NA, row.names = c("K","B","W"))
a <- data.frame(, row.names = c("K","B","W"))
a <- data.frame(c(1,2,3), row.names = c("K","B","W"))
a
a[1,]
a[2,]
a[3,]
a[4,]
a <- data.frame(list(K = 1, B = 2, W = 3))
a
a[1,]
a[2,] = c(4,4,4)
a
#   MAX(BETWEENSS) y MIN(WITHINSS)
testingOptimalK <- function(data){
optimistic <- as.integer(sqrt(nrow(data)/2))
kmin <- optimistic-6
kmax <- optimistic+6
if(kmin <= 0){
kmin <- 2
}
result <- data.frame(list(K = 1, betweens_to_max = 2, withins_to_min = 3))
print(paste("Iterando entre",kmin,"y",kmax,"..."))
for(k in kmin:kmax){
print(paste("k:",k))
current_row <- current_row + 1
kbet <- c()
kwit <- c()
for(i in 1:100){
kmeans_result <- kmeans(data,k)
kbet <- append(kbet,kmeans_result$betweenss)
kwit <- append(kwit,kmeans_result$tot.withinss)
}
result[current_row,] <- c(k, mean(kbet), mean(kwit))
}
return(result)
}
optimos_kmeans_videos <- testingOptimalK(videos_kmeans)
MAX(BETWEENSS) y MIN(WITHINSS)
testingOptimalK <- function(data){
optimistic <- as.integer(sqrt(nrow(data)/2))
kmin <- optimistic-6
kmax <- optimistic+6
if(kmin <= 0){
kmin <- 2
}
result <- data.frame(list(K = 1, betweens_to_max = 2, withins_to_min = 3))
print(paste("Iterando entre",kmin,"y",kmax,"..."))
current_row <- 0
for(k in kmin:kmax){
print(paste("k:",k))
current_row <- current_row + 1
kbet <- c()
kwit <- c()
for(i in 1:100){
kmeans_result <- kmeans(data,k)
kbet <- append(kbet,kmeans_result$betweenss)
kwit <- append(kwit,kmeans_result$tot.withinss)
}
result[current_row,] <- c(k, mean(kbet), mean(kwit))
}
return(result)
}
optimos_kmeans_videos <- testingOptimalK(videos_kmeans)
optimos_kmeans_videos
optimos_kmeans_videos <- testingOptimalK(videos_kmeans)
optimos_kmeans_videos
#   SE BUSCA MAXIMIZAR DISTANCIA ENTRE CENTROS (BETWEENESS) Y MINIMIZAR DISTANCIA ENTRE CENTROS Y SUS DATOS (WITHINESS)
#   MAX(BETWEENSS) y MIN(WITHINSS)
testingOptimalK <- function(data){
optimistic <- as.integer(sqrt(nrow(data)/2))
kmin <- optimistic-10
kmax <- optimistic+10
if(kmin <= 0){
kmin <- 2
}
result <- data.frame(list(K = 1, betweens_to_max = 2, withins_to_min = 3))
print(paste("Iterando entre",kmin,"y",kmax,"..."))
current_row <- 0
for(k in kmin:kmax){
print(paste("k:",k))
current_row <- current_row + 1
kbet <- c()
kwit <- c()
for(i in 1:100){
kmeans_result <- kmeans(data,k)
kbet <- append(kbet,kmeans_result$betweenss)
kwit <- append(kwit,kmeans_result$tot.withinss)
}
result[current_row,] <- c(k, mean(kbet), mean(kwit))
}
return(result)
}
optimos_kmeans_videos <- testingOptimalK(videos_kmeans)
optimos_kmeans_videos
# Librerias
library(arules)
library(klaR)
library(cluster)
library(graphics)
library(fpc)
library(optpart)
library(outliers)
optimos_kmeans_videos <- testingOptimalK(videos_kmeans)
optimos_kmeans_videos
testingOptimalK <- function(data,interval){
optimistic <- as.integer(sqrt(nrow(data)/2))
kmin <- optimistic-interval
kmax <- optimistic+interval
if(kmin <= 0){
kmin <- 2
}
result <- data.frame(list(K = 1, betweens_to_max = 2, withins_to_min = 3))
print(paste("Iterando entre",kmin,"y",kmax,"..."))
current_row <- 0
for(k in kmin:kmax){
print(paste("k:",k))
current_row <- current_row + 1
kbet <- c()
kwit <- c()
for(i in 1:100){
kmeans_result <- kmeans(data,k)
kbet <- append(kbet,kmeans_result$betweenss)
kwit <- append(kwit,kmeans_result$tot.withinss)
}
result[current_row,] <- c(k, mean(kbet), mean(kwit))
}
return(result)
}
optimos_kmeans_videos <- testingOptimalK(videos_kmeans,15)
optimos_kmeans_videos
optimos_kmeans_users <- testingOptimalK(users_kmeans,15)
warnings()
optimos_kmeans_users
plot(users_kmeans)
plot(video_kmeans)
plot(videos_kmeans)
plot(videos_kmeans, videos_kmeans)
str(videos_kmeans$points_per_view)
plot(videos_kmeans$points_per_view)
View(videos_kmeans)
str(users)
str(puntos_historicos)
str(users$puntos_historicos)
View(users)
plot(users$puntos_historicos)
plot(users$puntos_historicos,ylim=c(0,100000))
plot(users$puntos_historicos,ylim=c(0,80000))
plot(users$puntos_historicos)
plot(users$puntos_historicos,ylim=c(0,70000))
plot(users$puntos_historicos,ylim=c(0,80000))
users_clean <- users
str(users_clean)
plot(users_clean$puntos_historicos)
plot(users_clean$puntos_historicos,ylim=c(0,80000))
users_clean[users_clean$puntos_historicos <= 80000]
users_clean[users_clean$puntos_historicos <= 80000, ]
users_clean <- users_clean[users_clean$puntos_historicos <= 80000, ]
plot(users_clean$puntos_historicos)
str(users_clean)
plot(users_clean$puntos)
plot(users_clean$puntos,ylim=c(0,80000))
plot(users_clean$puntos,ylim=c(0,60000))
plot(users_clean$puntos,ylim=c(0,60000))
users_clean <- users_clean[users_clean$puntos <= 60000, ]
plot(users_clean$puntos)
str(users_clean)
plot(users_clean$puntos_gastados)
plot(users_clean$puntos_gastados)
plot(users_clean$puntos_gastados,ylim=c(0,60000))
users_clean <- users_clean[users_clean$puntos_gastados <= 60000, ]
plot(users_clean$puntos_gastados)
plot(users_clean$shares_totales)
plot(users_clean$shares_totales,ylim=c(0,100))
users_clean <- users_clean[users_clean$shares_totales <= 100, ]
users_clean <- users_clean[users_clean$shares_totales <= 100, ]
plot(users_clean$shares_totales)
plot(users_clean$shares_totales,ylim=c(0,70))
users_clean <- users_clean[users_clean$shares_totales <= 70, ]
plot(users_clean$shares_totales)
plot(users$concursos_participados)
plot(users_clean$concursos_participados)
plot(users_clean$concursos_participados,ylim=c(0,10))
users_clean <- users_clean[users_clean$concursos_participados <= 10, ]
plot(users_clean$concursos_participados)
plot(users_clean$premios_canjeados)
plot(users_clean$tickets_canjeados)
plot(users_clean$tickets_canjeados)
plot(users_clean$tickets_canjeados,ylim=c(0,50))
plot(users_clean$tickets_canjeados,ylim=c(0,40))
users_clean <- users_clean[users_clean$tickets_canjeados <= 40, ]
plot(users_clean$tickets_canjeados)
videos_clean <- videos
str(videos_clean)
plot(videos_clean$points_per_view)
plot(videos_clean$points_per_view,ylim=c(0,100))
videos_clean <- videos_clean[videos_clean$points_per_view <= 100, ]
plot(videos_clean$points_per_view)
plot(videos_clean$duracion)
plot(videos_clean$duracion,ylim=c(0,600))
plot(videos_clean$duracion,ylim=c(0,700))
plot(videos_clean$duracion,ylim=c(0,600))
plot(videos_clean$duracion,ylim=c(0,550))
plot(videos_clean$duracion,ylim=c(0,520))
videos_clean <- videos_clean[videos_clean$duracion <= 520, ]
plot(videos_clean$duracion)
plot(videos_clean$release_difference)
plot(videos_clean$release_difference,ylim=c(0,100000000))
plot(videos_clean$release_difference,ylim=c(0,1000000))
plot(videos_clean$release_difference,ylim=c(0,10000000))
plot(videos_clean$release_difference,ylim=c(0,1000000))
plot(videos_clean$release_difference,ylim=c(0,800000))
videos_clean <- videos_clean[videos_clean$release_difference <= 800000, ]
plot(videos_clean$release_difference)
videos_clean <- videos_clean[videos_clean$release_difference >= 0, ]
plot(videos_clean$release_difference)
plot(videos_clean$total_views)
plot(videos_clean$total_views,ylim=c(0,40000))
plot(videos_clean$total_views,ylim=c(0,20000))
plot(videos_clean$total_views,ylim=c(0,10000))
plot(videos_clean$total_views,ylim=c(0,80000))
plot(videos_clean$total_views,ylim=c(0,8000))
plot(videos_clean$total_views,ylim=c(0,6500))
videos_clean <- videos_clean[videos_clean$total_views <= 6500, ]
plot(videos_clean$total_views)
plot(videos_clean$points_given)
plot(videos_clean$points_given,ylim=c(0,100000))
videos_clean <- videos_clean[videos_clean$points_given <= 100000, ]
plot(videos_clean$points_given)
plot(videos_clean$shares_first_day)
plot(videos_clean$shares_first_day,ylim=c(0,15))
videos_clean <- videos_clean[videos_clean$shares_first_day <= 15, ]
plot(videos_clean$shares_first_week)
plot(videos_clean$shares_first_week,ylim=c(0,30))
plot(videos_clean$shares_first_week,ylim=c(0,25))
videos_clean <- videos_clean[videos_clean$shares_first_week <= 25, ]
plot(videos_clean$shares_first_week)
plot(videos_clean$total_shares)
plot(videos_clean$total_shares,ylim=c(0,60))
plot(videos_clean$total_shares,ylim=c(0,50))
plot(videos_clean$total_shares,ylim=c(0,45))
plot(videos_clean$total_shares,ylim=c(0,40))
videos_clean <- videos_clean[videos_clean$total_shares <= 40, ]
plot(videos_clean$total_shares)
plot(videos_clean$X1_week_active_users_at_release)
plot(videos_clean$X1_week_active_users_at_release,ylim=c(0,120))
plot(videos_clean$X1_week_active_users_at_release,ylim=c(0,100))
plot(videos_clean$X1_week_active_users_at_release,ylim=c(0,112000))
plot(videos_clean$X1_week_active_users_at_release,ylim=c(0,120))
videos_clean <- videos_clean[videos_clean$X1_week_active_users_at_release <= 120, ]
plot(videos_clean$points_per_view)
videos_clean <- videos
plot(videos_clean$points_per_view)
plot(videos_clean$points_per_view,ylim=c(0,110))
videos_clean <- videos_clean[videos_clean$points_per_view <= 110, ]
plot(videos_clean$duracion)
plot(videos_clean$duracion,ylim=c(0,600))
videos_clean <- videos_clean[videos_clean$duracion <= 600, ]
plot(videos_clean$release_difference)
plot(videos_clean$release_difference,ylim=c(0,800000))
plot(videos_clean$release_difference,ylim=c(0,900000))
plot(videos_clean$release_difference,ylim=c(0,1000000))
plot(videos_clean$release_difference,ylim=c(0,5000000))
plot(videos_clean$release_difference,ylim=c(0,1000000))
videos_clean <- videos_clean[videos_clean$release_difference <= 1000000, ]
videos_clean <- videos_clean[videos_clean$release_difference >= 0, ]
plot(videos_clean$total_views)
plot(videos_clean$total_views,ylim=c(0,7500))
plot(videos_clean$total_views,ylim=c(0,6500))
videos_clean <- videos_clean[videos_clean$total_views <= 6500, ]
plot(videos_clean$points_given)
plot(videos_clean$points_given,ylim=c(0,100000))
videos_clean <- videos_clean[videos_clean$points_given <= 100000, ]
plot(videos_clean$shares_first_day)
plot(videos_clean$shares_first_day,ylim=c(0,15))
videos_clean <- videos_clean[videos_clean$shares_first_day <= 15, ]
plot(videos_clean$shares_first_week)
plot(videos_clean$shares_first_week,ylim=c(0,30))
videos_clean <- videos_clean[videos_clean$shares_first_week <= 30, ]
plot(videos_clean$total_shares)
plot(videos_clean$total_shares,ylim=c(0,100))
plot(videos_clean$total_shares,ylim=c(0,80))
videos_clean <- videos_clean[videos_clean$total_shares <= 80, ]
plot(videos_clean$total_shares)
plot(videos_clean$X1_week_active_users_at_release)
plot(videos_clean$active_raffles_at_release)
optimos_kmeans_users_clean <- testingOptimalK(users_kmeans_clean,15)
users_kmeans_clean <- users_clean[keep]
rownames(users_kmeans_clean) <- NULL
users_kmeans_clean$tickets_canjeados <- sapply(users_kmeans_clean$tickets_canjeados, function(x){if(is.na(x)){ return(0)} else {return(x)} })
users_kmeans_clean <- users_kmeans_clean[users_kmeans_clean$difference_last_and_first_share != -1,]
users_kmeans_clean <- users_clean[keep]
keep <-c("puntos_historicos", "puntos", "puntos_gastados", "shares_totales", "concursos_participados","tickets_canjeados","difference_last_and_first_share")
users_kmeans_clean <- users_clean[keep]
rownames(users_kmeans_clean) <- NULL
users_kmeans_clean$tickets_canjeados <- sapply(users_kmeans_clean$tickets_canjeados, function(x){if(is.na(x)){ return(0)} else {return(x)} })
users_kmeans_clean <- users_kmeans_clean[users_kmeans_clean$difference_last_and_first_share != -1,]
keep <- c("points_per_view","duracion","total_views","total_shares","total_users_at_release","X1_week_active_users_at_release")
videos_kmeans_clean <- videos_clean[keep]
videos_kmeans_clean <- videos_kmeans_clean[complete.cases(videos_kmeans_clean), ] # SACAR ROWS CONMISSING VALUES
names(videos_kmeans_clean)[names(videos_kmeans_clean)=="X1_week_active_users_at_release"] <- "active_users"
names(videos_kmeans_clean)[names(videos_kmeans_clean)=="total_users_at_release"] <- "total_users"
optimos_kmeans_users_clean <- testingOptimalK(users_kmeans_clean,15)
optimos_kmeans_users <- testingOptimalK(users_kmeans,15)
optimos_kmeans_users_clean <- testingOptimalK(users_kmeans_clean,15)
users_kmeans_clean
View(users_kmeans_clean)
users_clean <- users
View(users_clean)
plot(users_clean$puntos_historicos)
plot(users_clean$puntos_historicos,ylim=c(0,80000))
users_clean <- users_clean[users_clean$puntos_historicos <= 80000, ]
plot(users_clean$puntos_historicos)
# puntos
plot(users_clean$puntos)
plot(users_clean$puntos,ylim=c(0,60000))
users_clean <- users_clean[users_clean$puntos <= 60000, ]
plot(users_clean$puntos)
# puntos_gastados
plot(users_clean$puntos_gastados)
plot(users_clean$puntos_gastados,ylim=c(0,60000))
users_clean <- users_clean[users_clean$puntos_gastados <= 60000, ]
plot(users_clean$puntos_gastados)
# shares_totales
plot(users_clean$shares_totales)
plot(users_clean$shares_totales,ylim=c(0,70))
users_clean <- users_clean[users_clean$shares_totales <= 70, ]
plot(users_clean$shares_totales)
# concursos_participados
plot(users_clean$concursos_participados)
plot(users_clean$concursos_participados,ylim=c(0,10))
users_clean <- users_clean[users_clean$concursos_participados <= 10, ]
plot(users_clean$concursos_participados)
# tickets_canjeados
plot(users_clean$tickets_canjeados)
plot(users_clean$tickets_canjeados,ylim=c(0,40))
users_clean <- users_clean[users_clean$tickets_canjeados <= 40, ]
plot(users_clean$tickets_canjeados)
View(users_clean)
users_clean <- users
View(users_clean)
users_clean[users_clean$puntos_historicos <= 80000, ]
View(users_clean)
users_clean <- users
users_clean <- subset(users_clean, puntos_historicos <= 80000)
View(users_clean)
users_clean <- subset(users_clean, puntos <= 60000)
View(users_clean)
users_clean <- subset(users_clean, puntos_gastados <= 60000)
users_clean <- subset(users_clean, shares_totales <= 70)
users_clean <- subset(users_clean, concursos_participados <= 10)
users_clean <- subset(users_clean, tickets_canjeados <= 40)
View(users_clean)
videos_clean <- videos
videos_clean <- subset(videos_clean, points_per_view <= 110)
videos_clean <- subset(videos_clean, duracion <= 600)
videos_clean <- subset(videos_clean, release_difference <= 1000000)
videos_clean <- subset(videos_clean, release_difference >= 0)
videos_clean <- subset(videos_clean, total_views <= 6500)
videos_clean <- subset(videos_clean, points_given <= 100000)
videos_clean <- subset(videos_clean, shares_first_day <= 15)
videos_clean <- subset(videos_clean, shares_first_week <= 30)
videos_clean <- subset(videos_clean, total_shares <= 80)
View(videos_clean)
keep <-c("puntos_historicos", "puntos", "puntos_gastados", "shares_totales", "concursos_participados","tickets_canjeados","difference_last_and_first_share")
users_kmeans_clean <- users_clean[keep]
View(videos_clean)
View(users_clean)
View(users_kmeans_clean)
rownames(users_kmeans_clean) <- NULL
users_kmeans_clean$tickets_canjeados <- sapply(users_kmeans_clean$tickets_canjeados, function(x){if(is.na(x)){ return(0)} else {return(x)} })
users_kmeans_clean2 <- users_kmeans_clean[users_kmeans_clean$difference_last_and_first_share != -1,]
View(users_kmeans_clean2)
users_kmeans_clean <- users_kmeans_clean[users_kmeans_clean$difference_last_and_first_share != -1,]
keep <- c("points_per_view","duracion","total_views","total_shares","total_users_at_release","X1_week_active_users_at_release")
videos_kmeans <- videos[keep]
videos_kmeans <- videos_kmeans[complete.cases(videos_kmeans), ] # SACAR ROWS CONMISSING VALUES
names(videos_kmeans)[names(videos_kmeans)=="X1_week_active_users_at_release"] <- "active_users"
names(videos_kmeans)[names(videos_kmeans)=="total_users_at_release"] <- "total_users"
videos_kmeans_clean <- videos_clean[keep]
videos_kmeans_clean <- videos_kmeans_clean[complete.cases(videos_kmeans_clean), ] # SACAR ROWS CONMISSING VALUES
names(videos_kmeans_clean)[names(videos_kmeans_clean)=="X1_week_active_users_at_release"] <- "active_users"
names(videos_kmeans_clean)[names(videos_kmeans_clean)=="total_users_at_release"] <- "total_users"
optimos_kmeans_users_clean <- testingOptimalK(users_kmeans_clean,15)
View(users_clean)
users_clean <- users
plot(users_clean$puntos_historicos)
plot(users_clean$puntos_historicos,ylim=c(0,80000))
users_clean <- subset(users_clean, puntos_historicos <= 80000)
plot(users_clean$puntos_historicos)
plot(users_clean$puntos)
plot(users_clean$puntos,ylim=c(0,60000))
users_clean <- subset(users_clean, puntos <= 60000)
plot(users_clean$puntos_gastados)
plot(users_clean$puntos_gastados,ylim=c(0,60000))
users_clean <- subset(users_clean, puntos_gastados <= 60000)
plot(users_clean$shares_totales)
plot(users_clean$shares_totales,ylim=c(0,100))
users_clean <- subset(users_clean, shares_totales <= 100)
plot(users_clean$shares_totales)
plot(users_clean$concursos_participados)
plot(users_clean$concursos_participados,ylim=c(0,10))
users_clean <- subset(users_clean, concursos_participados <= 10)
plot(users_clean$concursos_participados)
plot(users_clean$tickets_canjeados)
plot(users_clean$tickets_canjeados,ylim=c(0,40))
plot(users_clean$tickets_canjeados)
users_clean <- subset(users_clean, tickets_canjeados <= 45)
users_clean <- users
str(users_clean)
# puntos_historicos
plot(users_clean$puntos_historicos)
plot(users_clean$puntos_historicos,ylim=c(0,80000))
users_clean <- subset(users_clean, puntos_historicos <= 80000)
plot(users_clean$puntos_historicos)
# puntos
plot(users_clean$puntos)
plot(users_clean$puntos,ylim=c(0,60000))
users_clean <- subset(users_clean, puntos <= 60000)
plot(users_clean$puntos)
# puntos_gastados
plot(users_clean$puntos_gastados)
plot(users_clean$puntos_gastados,ylim=c(0,60000))
users_clean <- subset(users_clean, puntos_gastados <= 60000)
plot(users_clean$puntos_gastados)
# shares_totales
plot(users_clean$shares_totales)
plot(users_clean$shares_totales,ylim=c(0,100))
users_clean <- subset(users_clean, shares_totales <= 100)
plot(users_clean$shares_totales)
# concursos_participados
plot(users_clean$concursos_participados)
plot(users_clean$concursos_participados,ylim=c(0,10))
users_clean <- subset(users_clean, concursos_participados <= 10)
plot(users_clean$concursos_participados)
users_clean$tickets_canjeados <- sapply(users_clean$tickets_canjeados, function(x){if(is.na(x)){ return(0)} else {return(x)} })
users_clean <- subset(users_clean, tickets_canjeados <= 45)
keep <-c("puntos_historicos", "puntos", "puntos_gastados", "shares_totales", "concursos_participados","tickets_canjeados","difference_last_and_first_share")
users_kmeans_clean <- users_clean[keep]
rownames(users_kmeans_clean) <- NULL
users_kmeans_clean <- users_kmeans_clean[users_kmeans_clean$difference_last_and_first_share != -1,]
optimos_kmeans_users_clean <- testingOptimalK(users_kmeans_clean,15)
optimos_kmeans_users_clean
optimos_kmeans_users
